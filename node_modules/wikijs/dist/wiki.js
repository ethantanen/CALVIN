'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),exports.default=wiki;var _util=require('./util'),_page=require('./page'),_page2=_interopRequireDefault(_page);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var defaultOptions={apiUrl:'http://en.wikipedia.org/w/api.php',origin:'*'};function wiki(){function a(m){return m.query.redirects&&1===m.query.redirects.length?(0,_util.api)(l,{prop:'info|pageprops',inprop:'url',ppprop:'disambiguation',titles:m.query.redirects[0].to}):m}function b(m){var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:50;return(0,_util.pagination)(l,{list:'search',srsearch:m,srlimit:n},function(o){return o.query.search.map(function(p){return p.title})})}function d(m){return(0,_util.api)(l,{prop:'info|pageprops',inprop:'url',ppprop:'disambiguation',titles:m}).then(a).then(function(n){var o=Object.keys(n.query.pages)[0];if(!o||'-1'===o)throw new Error('No article found');return(0,_page2.default)(n.query.pages[o],l)})}var k=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};this instanceof wiki&&console.log('Please do not use wikijs ^1.0.0 as a class. Please see the new README.');var l=Object.assign({},defaultOptions,k);return{search:b,random:function(){var m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return(0,_util.api)(l,{list:'random',rnnamespace:0,rnlimit:m}).then(function(n){return n.query.random.map(function(o){return o.title})})},page:d,geoSearch:function(m,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1e3;return(0,_util.api)(l,{list:'geosearch',gsradius:o,gscoord:m+'|'+n}).then(function(p){return p.query.geosearch.map(function(q){return q.title})})},options:k,findById:function(m){return(0,_util.api)(l,{prop:'info|pageprops',inprop:'url',ppprop:'disambiguation',pageids:m}).then(a).then(function(n){var o=Object.keys(n.query.pages)[0];if(!o||'-1'===o)throw new Error('No article found');return(0,_page2.default)(n.query.pages[o],l)})},find:function(m){var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:function(o){return o[0]};return b(m).then(function(o){return n(o.results)}).then(function(o){return d(o)})},allPages:function(){return(0,_util.aggregate)(l,{},'allpages','title','ap')},allCategories:function(){return(0,_util.aggregate)(l,{},'allcategories','*','ac')},pagesInCategory:function(m){return(0,_util.aggregate)(l,{cmtitle:m},'categorymembers','title','cm')}}}
//# sourceMappingURL=wiki.js.map